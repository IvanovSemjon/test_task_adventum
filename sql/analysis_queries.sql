
-- АНАЛИЗ ВЛИЯНИЯ НА КОЛИЧЕСТВО ЛАЙКОВ

-- 1. Влияние времени суток на лайки
SELECT 
    Час_дня,
    COUNT(*) as Количество_постов,
    AVG(Лайки) as Среднее_лайков,
    MAX(Лайки) as Максимум_лайков
FROM posts_stats 
GROUP BY Час_дня 
ORDER BY Среднее_лайков DESC;

-- 2. Влияние дня недели на лайки
SELECT 
    День_недели,
    COUNT(*) as Количество_постов,
    AVG(Лайки) as Среднее_лайков,
    MAX(Лайки) as Максимум_лайков
FROM posts_stats 
GROUP BY День_недели, Номер_дня_недели 
ORDER BY Номер_дня_недели;

-- 3. Влияние промежутка между постами на лайки
SELECT 
    CASE 
        WHEN Часов_с_предыдущего_поста = 0 THEN 'Первый пост'
        WHEN Часов_с_предыдущего_поста < 24 THEN 'Менее суток'
        WHEN Часов_с_предыдущего_поста < 168 THEN '1-7 дней'
        ELSE 'Более недели'
    END as Категория_интервала,
    COUNT(*) as Количество_постов,
    AVG(Лайки) as Среднее_лайков
FROM posts_stats 
GROUP BY Категория_интервала 
ORDER BY Среднее_лайков DESC;

-- 4. Корреляционный анализ
SELECT 
    'Час_дня' as Фактор,
    CORR(Час_дня, Лайки) as Корреляция
FROM posts_stats
UNION ALL
SELECT 
    'Номер_дня_недели' as Фактор,
    CORR(Номер_дня_недели, Лайки) as Корреляция
FROM posts_stats
UNION ALL
SELECT 
    'Часов_с_предыдущего_поста' as Фактор,
    CORR(Часов_с_предыдущего_поста, Лайки) as Корреляция
FROM posts_stats
WHERE Часов_с_предыдущего_поста > 0;
        